% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/MLASDO.R
\name{run_mlasdo}
\alias{run_mlasdo}
\title{Run the MLASDO pipeline}
\usage{
run_mlasdo(
  omic_data = "data/datasets/omic_data_ppmi_sc_npc_nm.rds",
  clinical_data = "data/datasets/clinic_data_PPMI_SC_no_mutation.rds",
  id_column = "participant_id",
  target_column = "diagnosis_type",
  target_positive_class = "Case",
  target_negative_class = "Control",
  output_dir = NULL,
  always_split_variables = c("age_at_baseline", "sex"),
  feature_selection_exec = TRUE,
  feature_selection_existing_dir = NULL,
  rf_mtry = NULL,
  rf_splitrule = c("gini", "extratrees", "hellinger"),
  rf_min_node_size = c(1, 5, 10),
  rf_train_method = "repeatedcv",
  rf_train_number = 10,
  rf_train_repeats = 5,
  rf_num_trees = 500,
  rf_model_filename = "rf_feature_selection.rds",
  rf_importance = "permutation",
  n_cores = max(1, parallel::detectCores() - 1),
  seed = 123,
  svm_exec = TRUE,
  svm_output_dir = NULL,
  svm_existing_dir = NULL,
  svm_kernels = c("linear", "radial", "polynomial"),
  svm_linear_cost_values = 10^seq(-6, 6, length.out = 13),
  svm_radial_cost_values = 10^seq(-4, 4, length.out = 9),
  svm_radial_sigma_values = 10^seq(-6, 1, length.out = 8),
  svm_polynomial_cost_values = 10^seq(-4, 4, length.out = 9),
  svm_polynomial_degree_values = 2:4,
  svm_polynomial_scale_values = 10^seq(-6, 0, length.out = 7),
  svm_num_folds = 10,
  svm_sampling = "down",
  anomalies_exec = TRUE,
  anomalies_method = "sd",
  anomalies_sd_multiplier = 2,
  anomalies_z_threshold = 1.65,
  anomalies_output_dir = NULL,
  anomaly_numeric_vars = NULL,
  anomaly_categorical_vars = NULL
)
}
\arguments{
\item{omic_data}{Path to an \code{.rds} file or a data frame with molecular
measurements. Defaults to \code{data/datasets/omic_data_ppmi_sc_npc_nm.rds}
inside the repository.}

\item{clinical_data}{Path or data frame with the clinical annotations. Defaults
to \code{data/datasets/clinic_data_PPMI_SC_no_mutation.rds}.}

\item{id_column}{Name of the column that uniquely identifies each subject.}

\item{target_column}{Name of the response variable used across downstream
analyses.}

\item{target_positive_class}{Label within \code{target_column} treated as the
positive class (defaults to \code{"Case"}).}

\item{target_negative_class}{Label treated as the negative class (defaults to
\code{"Control"}). Both values must exist in the dataset.}

\item{output_dir}{Directory where MLASDO will create subfolders for
preprocessing and feature selection. The directory is created if it does
not exist.}

\item{always_split_variables}{Character vector passed to
\code{ranger::ranger(always.split.variables = ...)} to force covariates to be
part of each split. Values are pulled from the clinical dataset (and added
to the modeling table if needed). Defaults to \code{c("age_at_baseline", "sex")}.}

\item{feature_selection_exec}{Execute the RF-based feature-selection step.
When \code{FALSE}, \code{feature_selection_existing_dir} must point to a folder with
previously generated artifacts (trimmed dataset and importance files).}

\item{feature_selection_existing_dir}{Directory containing an existing
feature-selection run (expects \code{omic_selected_features.rds},
\code{feature_importance_values.rds}, and \code{feature_importance_summary.rds}).}

\item{rf_mtry}{Candidate \code{mtry} values. If \code{NULL}, defaults to the sequence
originally used in MLASDO (\code{floor(seq(2, sqrt(p), length.out = 3))}).}

\item{rf_splitrule}{Candidate split rules (defaults to
\code{c("gini", "extratrees", "hellinger")}).}

\item{rf_min_node_size}{Candidate \code{min.node.size} values (defaults to
\code{c(1, 5, 10)}).}

\item{rf_train_method}{Resampling strategy for \code{caret::trainControl}
(\code{"repeatedcv"} or \code{"cv"}). Defaults to \code{"repeatedcv"}.}

\item{rf_train_number}{Number of folds used in resampling (defaults to 10).}

\item{rf_train_repeats}{Number of repeats when \code{rf_train_method = "repeatedcv"}
(defaults to 5).}

\item{rf_num_trees}{Number of trees passed to \code{ranger} (defaults to 500).}

\item{rf_model_filename}{File name used to persist the feature-selection
model inside the feature-selection folder. Defaults to
\code{"rf_feature_selection.rds"}.}

\item{rf_importance}{Importance measure passed to \code{ranger}. Defaults to
\code{"permutation"} but it can be set to any value supported by \code{ranger}
(e.g., \code{"impurity"}).}

\item{n_cores}{Number of CPU cores allocated to MLASDO (feature selection and
SVM training). Defaults to \code{parallel::detectCores() - 1}.}

\item{seed}{Random seed applied before starting the feature-selection phase
and reused for the SVM folds.}

\item{svm_exec}{Run the post-selection SVM training workflow once the
trimmed dataset is available. Defaults to \code{TRUE}.}

\item{svm_output_dir}{Directory used to store the SVM artifacts. Defaults to
a \code{svm_models} subfolder inside \code{output_dir}.}

\item{svm_existing_dir}{Directory with previously trained SVM models. Used
when \code{svm_exec = FALSE} but the artifacts should be reused.}

\item{svm_kernels}{Character vector with any subset of \code{"linear"},
\code{"radial"} or \code{"polynomial"} kernels passed to
\code{mlasdo_train_svm_models()}.}

\item{svm_linear_cost_values}{Candidate \code{C} values for the linear SVM grid
when \code{svm_kernels} includes \code{"linear"}.}

\item{svm_radial_cost_values}{Candidate \code{C} values for the radial SVM grid.}

\item{svm_radial_sigma_values}{Candidate \code{sigma}/\code{gamma} values for the
radial kernel.}

\item{svm_polynomial_cost_values}{Candidate \code{C} values for the polynomial
kernel.}

\item{svm_polynomial_degree_values}{Candidate degrees evaluated for the
polynomial kernel.}

\item{svm_polynomial_scale_values}{Candidate \code{scale} (\code{gamma}) values
evaluated for the polynomial kernel.}

\item{svm_num_folds}{Number of folds reused across the SVM kernels. Defaults
to 10 and independent from the RF resampling settings.}

\item{svm_sampling}{Sampling strategy passed to the underlying
\code{trainControl(sampling = ...)}.}

\item{anomalies_exec}{Run the anomalous-individuals selection after the SVM
stage finishes (defaults to \code{TRUE}).}

\item{anomalies_method}{Strategy used to flag anomalies. Defaults to \code{"sd"}
(mean Â± SD) but \code{"zscore"} can also be used.}

\item{anomalies_sd_multiplier}{Multiplier applied to the per-class SD when
\code{anomalies_method = "sd"}.}

\item{anomalies_z_threshold}{Absolute z-score threshold applied when
\code{anomalies_method = "zscore"}.}

\item{anomalies_output_dir}{Directory where anomaly-related artifacts will be
stored. Defaults to an \code{anomalies} subfolder under \code{output_dir}.}

\item{anomaly_numeric_vars}{Optional character vector with the clinical
numeric variables evaluated when comparing anomalous individuals.}

\item{anomaly_categorical_vars}{Optional character vector with the clinical
categorical variables evaluated during the anomaly analysis.}
}
\value{
An invisible list with \code{omic}, \code{clinical}, \code{feature_selection_model},
the trimmed omic dataset, and \code{metadata} entries.
}
\description{
Loads the omic and clinical datasets, validates the ID/target columns, and
returns aligned data frames so the remaining analytical scripts can rely on
a single entry point. Once aligned, a feature-selection step based on a
random forest is executed to mirror the current MLASDO workflow and the
trimmed omic dataset with the most important features is stored. All
artifacts are organised in dedicated subfolders under the provided
\code{output_dir}.
}
